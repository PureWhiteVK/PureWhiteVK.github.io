---
title: 470. 用Rand7()实现Rand10()
mathjax: true
tags:
  - 算法
category: LeetCode刷题记录
abbrlink: 4be5
date: 2021-09-05
---
# 470. 用Rand7()实现Rand10()

已有方法 rand7 可生成 1 到 7 范围内的均匀随机整数，试写一个方法 rand10 生成 1 到 10 范围内的均匀随机整数。

不要使用系统的 Math.random() 方法。

> 链接：https://leetcode-cn.com/problems/implement-rand10-using-rand7

<!-- more -->

## 数学

首先看到这个题目确实没什么思路【概率论都忘完了】，其实考察的就是概率论

> 已知 rand_N() 可以等概率的生成[1, N]范围的随机数
> 那么：
> (rand_X() - 1) × Y + rand_Y() ==> 可以等概率的生成[1, X * Y]范围的随机数
> 即实现了 rand_XY()
>
> 作者：kkbill
> 链接：https://leetcode-cn.com/problems/implement-rand10-using-rand7/solution/cong-zui-ji-chu-de-jiang-qi-ru-he-zuo-dao-jun-yun-/
> 来源：力扣（LeetCode）
> 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

设数A是[1,X\*Y]内的任意一个数，如果将其看成是A/Y的结果记为 a 和余数情况记为 b，那么A/Y\*Y + A%Y = A

那么对于Rand7() -> Rand10()

使用这个思路，可以做两次随机采样，且使用公式 Rand7() + (Rand7-1) \* 7 来生成 [1,49] 的均匀分布，之后使用拒绝采样思想，当生成1～40的数时接受结果，生成41～49时拒绝（就是当这次抽样失败，进行下一次），这样可以从[1～49]转化成[1\~40]的均匀分布，由于其每个数字出现的概率都是一样的，那么再对10取余+1就可得到[1~10]的均匀分布，思路是这样，但是我们每次进行采样都有9/49的概率进行下一次抽样，如果能够降低这个概率，就可以减少重新采样的次数

```java
/**
 * The rand7() API is already defined in the parent class SolBase.
 * public int rand7();
 * @return a random integer in the range 1 to 7
 */
class Solution extends SolBase {
    public int rand10() {
        int v;
        do {
            // idx一定是1～49内的一个数,因为col代表的余数，(row-1)代表的是除数
            v = rand7() + (rand7() - 1) * 7;
            // 生成 v 的概率是 1/49，然后取前40个，那么就是
        } while (v > 40);
        return 1 + (v - 1) % 10;
    }
}
```

0～39 % 10

0，1，2，3，4，5，6，7，8，9，

0，1，2，3，4，5，6，7，8，9，

0，1，2，3，4，5，6，7，8，9

0，1，2，3，4，5，6，7，8，9

1～40 % 10

1，2，3，4，5，6，7，8，9，0

1，2，3，4，5，6，7，8，9，0

1，2，3，4，5，6，7，8，9，0

1，2，3，4，5，6，7，8，9，0

实际上没有区别，因此 (v-1) % 10感觉意义不大

```java
/**
 * The rand7() API is already defined in the parent class SolBase.
 * public int rand7();
 * @return a random integer in the range 1 to 7
 */
class Solution extends SolBase {
    public int rand10() {
        int v;
        while(true) {
            // idx一定是1～49内的一个数,因为col代表的余数，(row-1)代表的是除数
            v = rand7() + (rand7() - 1) * 7;
            if(v < 41) return v % 10 + 1;
            // 此时 v 是 [1~9]的均匀分布
            v -= 40;
            v = rand7() + ( v - 1 ) * 7;
            // 此时 v 是 [1~63]的均匀分布
            if(v < 61) return v % 10 + 1;
            v -= 60;
            // 此时 v 是 [1~3] 的均匀分布
            v = rand7() + ( v - 1) * 7;
            if(v < 21) return v % 10 + 1;
            // 最后只有一个1，拒绝采样
        } 
    }
}
```

*注：这个题其实很有实际意义，对于一个给定范围的均匀分布，我们要能够构造出任意区间的均匀分布，同时需要理解拒绝采样思想，限定样本的分布