---
title: 371. 两整数之和
mathjax: true
tags:
  - 算法
category: LeetCode刷题记录
abbrlink: c75
date: 2021-09-26
---
# 371. 两整数之和

给你两个整数 `a` 和 `b` ，**不使用** 运算符 `+` 和 `-` ，计算并返回两整数之和。

**提示：**

- `-1000 <= a, b <= 1000`

> [371. 两整数之和 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/sum-of-two-integers/)

<!-- more -->

## 位运算

这一题考查使用位运算实现加法，那么我们就从二进制数的加法来看如何计算加法的

以两个二进制数 0b0111 和 0b1110 为例

首先看最低位，

sum = a0+b0+carry = 1，

当前位值为 sum % 2 = 1，进位 sum / 2 = 0

再看前一位

sum = a1+b1+carry = 2

当前位值为 sum %2 = 0，进位 sum / 2 = 1

再前看一位

sum = a2+b2+carry= 3

当前位值位 sum % 2 = 1，进位 sum / 2 = 1

再看前一位

sum = a3+b3+carry = 2

当前位值位 sum % 2 = 0，进位 sum / 2 = 1

此时carry不为0，那么结果上还需要进一位

最终结果位 0b10101

从这个结果中可以看出，由于int只包含32位，我们只需要分别计算32个位上的结果即可

```java
class Solution {
    public int getSum(int a, int b) {
        int res = 0,i,a1,b1,c=0;
        for(i=0;i<32;++i){
          	// 每次读取第i位的值
            a1 = (a>>i)&1;
            b1 = (b>>i)&1;
          	// a1+b1有三种情况，0，1，2，之后再分别讨论进位的情况
            // 这个代码写的属实有点丑陋
            if(a1 == 1 && b1 == 1){
              	// 如果进位为1，说明sum = 3，当前位为1，且进位也为1
              	// 如果进位为0，说明sum = 2，当前位为0，进位为1
                // if(c == 1){
                //     res |= (1<<i);
                // }
                res |= (c<<i);
                c = 1;
            }else if(a1 == 0 && b1 == 0){
              	// 如果进位为1，说明sum=1，当前位为1，进位为0
              	// 如果进位为0，说明sum=0，当前位位0，进位也为0
                // if(c == 1){
                //     res |= (1<<i);
                // }
                res |= (c<<i);
                c = 0;
            }else{
              	// 如果进位为1，说明sum=2，当前位为0，进位为1
              	// 如果进位为0，说明sum=1，当前位为1，进位为0
                // if(c == 1){
                //     c = 1;
                // }else{
                //     res |= (1<<i);
                //     c = 0;
                // }
                res |= ((1^c)<<i);
            }
        }
        return res;
    }
}
```

实际上对a+b进行分解，可以分为两步，第一步是a^b（即不进位的加法），第二步是a&b（下一位的进位情况）再将这两数的结果累加就可以得到两个数加法的结果，这个可以写成迭代的方式

### 迭代写法

```java
class Solution{
  public int getSum(int a,int b){
		int c = 0;
    while(b!=0){
      c = (a&b)<<1;
      a = a ^ b;
      b = c;
    }
    return a;
  }
}
```

### 递归写法

```java
class Solution{
	public int getSum(int a,int b){
    return b == 0 ? a : getSum(a^b,(a&b)<<1);
  }
}
```

