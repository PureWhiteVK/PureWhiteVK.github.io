---
title: 剑指 Offer 65. 不用加减乘除做加法
mathjax: true
tags:
  - 算法
category: LeetCode刷题记录
abbrlink: 862c
date: 2021-08-28
---
# 剑指 Offer 65. 不用加减乘除做加法

写一个函数，求两个整数之和，要求在函数体内不得使用 “+”、“-”、“*”、“/” 四则运算符号。\

> [剑指 Offer 65. 不用加减乘除做加法 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/bu-yong-jia-jian-cheng-chu-zuo-jia-fa-lcof/)

<!-- more -->

## 位运算

由于不能使用四则运算符号计算加法，那么就需要使用位运算来模拟加法操作

首先考虑单比特的计算，设有一位信号a和b

那么对于a和b而言其相加共有四种情况

| a    | 0    | 0    | 1    | 1    |
| ---- | ---- | ---- | ---- | ---- |
| b    | 0    | 1    | 0    | 1    |
| r    | 0    | 1    | 1    | 0    |
| v    | 0    | 0    | 0    | 1    |

其中r代表不进位的结果，v代表进位的结果

那么对于一个正常的数，例如 30 + 17，下面我们来模拟一下计算过程

17 -> 0b0001_0001

30 -> 0b0001_1110

step1:

r = a ^ b = 0b0000_1111

v = ( a & b ) << 1 = 0b0010_0000

a = r

b = b

step2:

r = a ^ b = 0b0010_1111

v = ( a & b ) << 1 =  0b0000_0000

此时没有进位，说明计算完成，30+17的结果就是47 -> 0b0010_1111

了解了过程，实际上代码实现起来就很简单

```java
class Solution {
    public int add(int a, int b) {
        int r,v;
        while(b!=0){
            // 不进位相加的结果
            r = a ^ b;
            // 进位结果
          	// 当前位进位结果需要配合下一位的一起计算，因此需要左移一位
            v = (a & b) << 1;
            a = r;
            b = v;
        } 
        return a;
    }
}
```

而由于负数在计算机中使用补码表示，加减法可以统一处理，该方法不需要修改直接适用于负数的计算